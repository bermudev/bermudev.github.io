---
import ThemeToggle from "../ThemeToggle.astro";
import Search from "../Search.astro";
import { menuLinks } from "@/site-config";

const url = new URL(Astro.request.url);
---

<header id="main-header" class="group relative mb-28 flex items-center sm:ps-[4.5rem]">
	<a
		href="/"
		class="inline-flex items-center grayscale hover:filter-none sm:relative sm:inline-block"
		aria-current={url.pathname === "/" ? "page" : false}
	>
		<svg
			class="me-3 h-10 w-10 sm:absolute sm:start-[-4.5rem] sm:me-0 sm:h-20 sm:w-20"
			aria-hidden="true"
			focusable="false"
			fill="none"
			xmlns="http://www.w3.org/2000/svg"
			viewBox="0 0 600 600"
		>
			<title>Logo</title>
			<g><path style="opacity:0.993" fill="#7ee781" d="M 255.5,30.5 C 255.5,70.5 255.5,110.5 255.5,150.5C 235.5,150.5 215.5,150.5 195.5,150.5C 198.601,139.632 202.268,128.966 206.5,118.5C 219.259,86.9641 235.592,57.6307 255.5,30.5 Z"/></g>
			<g><path style="opacity:1" fill="#5bc97f" d="M 255.5,30.5 C 274.127,58.0742 290.46,87.0742 304.5,117.5C 308.163,128.155 311.83,138.822 315.5,149.5C 295.674,150.497 275.674,150.83 255.5,150.5C 255.5,110.5 255.5,70.5 255.5,30.5 Z"/></g>
			<g><path style="opacity:0.99" fill="#02914c" d="M 206.5,118.5 C 202.268,128.966 198.601,139.632 195.5,150.5C 192.408,157.853 190.074,165.52 188.5,173.5C 184.5,170.167 180.5,166.833 176.5,163.5C 168.772,157.774 160.772,152.441 152.5,147.5C 143.528,141.676 134.194,136.343 124.5,131.5C 122.668,130.752 121.001,129.752 119.5,128.5C 125.281,103.987 132.781,79.9875 142,56.5C 165.956,74.6225 187.456,95.2892 206.5,118.5 Z"/></g>
			<g><path style="opacity:0.994" fill="#02914c" d="M 390.5,128.5 C 389.685,129.837 388.518,130.837 387,131.5C 386.333,132.167 386.333,132.833 387,133.5C 413.833,160.333 440.667,187.167 467.5,214C 468.448,214.483 469.448,214.649 470.5,214.5C 465.657,224.194 460.324,233.528 454.5,242.5C 422.701,211.201 391.035,179.701 359.5,148C 350.649,151.804 342.483,156.971 335,163.5C 334.333,164.167 334.333,164.833 335,165.5C 369.418,199.417 403.252,233.75 436.5,268.5C 430.913,276.757 424.246,284.09 416.5,290.5C 387.833,261.167 358.833,232.167 329.5,203.5C 327.965,195.829 326.299,188.162 324.5,180.5C 322.257,169.846 319.257,159.513 315.5,149.5C 311.83,138.822 308.163,128.155 304.5,117.5C 323.871,95.2953 345.038,74.962 368,56.5C 377.617,79.8499 385.117,103.85 390.5,128.5 Z"/></g>
			<g><path style="opacity:0.988" fill="#5ac97f" d="M -0.5,89.5 C 41.2299,97.2992 81.2299,110.299 119.5,128.5C 121.001,129.752 122.668,130.752 124.5,131.5C 96.8333,159.5 69.1667,187.5 41.5,215.5C 28.3774,189.651 17.8774,162.651 10,134.5C 6.47109,121.045 2.97109,107.712 -0.5,94.5C -0.5,92.8333 -0.5,91.1667 -0.5,89.5 Z"/></g>
			<g><path style="opacity:0.99" fill="#00aa5d" d="M 511.5,89.5 C 511.5,91.1667 511.5,92.8333 511.5,94.5C 502.24,135.945 488.574,175.945 470.5,214.5C 469.448,214.649 468.448,214.483 467.5,214C 440.667,187.167 413.833,160.333 387,133.5C 386.333,132.833 386.333,132.167 387,131.5C 388.518,130.837 389.685,129.837 390.5,128.5C 429.187,110.493 469.521,97.4934 511.5,89.5 Z"/></g>
			<g><path style="opacity:0.997" fill="#01ab5e" d="M 124.5,131.5 C 134.194,136.343 143.528,141.676 152.5,147.5C 120.5,179.167 88.5,210.833 56.5,242.5C 50.7427,233.991 45.7427,224.991 41.5,215.5C 69.1667,187.5 96.8333,159.5 124.5,131.5 Z"/></g>
			<g><path style="opacity:0.998" fill="#5ac87f" d="M 152.5,147.5 C 160.772,152.441 168.772,157.774 176.5,163.5C 143.252,198.25 109.418,232.583 75,266.5C 74.5357,267.094 74.369,267.761 74.5,268.5C 68.0194,260.219 62.0194,251.552 56.5,242.5C 88.5,210.833 120.5,179.167 152.5,147.5 Z"/></g>
			<g><path style="opacity:0.998" fill="#00aa5d" d="M 454.5,242.5 C 448.981,251.552 442.981,260.219 436.5,268.5C 403.252,233.75 369.418,199.417 335,165.5C 334.333,164.833 334.333,164.167 335,163.5C 342.483,156.971 350.649,151.804 359.5,148C 391.035,179.701 422.701,211.201 454.5,242.5 Z"/></g>
			<g><path style="opacity:1" fill="#5bc97f" d="M 195.5,150.5 C 215.5,150.5 235.5,150.5 255.5,150.5C 255.5,160.5 255.5,170.5 255.5,180.5C 232.833,180.5 210.167,180.5 187.5,180.5C 187.674,178.139 188.007,175.806 188.5,173.5C 190.074,165.52 192.408,157.853 195.5,150.5 Z"/></g>
			<g><path style="opacity:1" fill="#01ab5e" d="M 315.5,149.5 C 319.257,159.513 322.257,169.846 324.5,180.5C 301.5,180.5 278.5,180.5 255.5,180.5C 255.5,170.5 255.5,160.5 255.5,150.5C 275.674,150.83 295.674,150.497 315.5,149.5 Z"/></g>
			<g><path style="opacity:0.998" fill="#02ab5e" d="M 176.5,163.5 C 180.5,166.833 184.5,170.167 188.5,173.5C 188.007,175.806 187.674,178.139 187.5,180.5C 185.342,187.611 183.675,194.944 182.5,202.5C 152.833,231.5 123.5,260.833 94.5,290.5C 86.7538,284.09 80.0871,276.757 74.5,268.5C 74.369,267.761 74.5357,267.094 75,266.5C 109.418,232.583 143.252,198.25 176.5,163.5 Z"/></g>
			<g><path style="opacity:1" fill="#7ee780" d="M 187.5,180.5 C 210.167,180.5 232.833,180.5 255.5,180.5C 255.5,190.5 255.5,200.5 255.5,210.5C 230.833,210.5 206.167,210.5 181.5,210.5C 181.833,207.833 182.167,205.167 182.5,202.5C 183.675,194.944 185.342,187.611 187.5,180.5 Z"/></g>
			<g><path style="opacity:1" fill="#5ac87f" d="M 255.5,180.5 C 278.5,180.5 301.5,180.5 324.5,180.5C 326.299,188.162 327.965,195.829 329.5,203.5C 329.5,205.833 329.5,208.167 329.5,210.5C 304.833,210.5 280.167,210.5 255.5,210.5C 255.5,200.5 255.5,190.5 255.5,180.5 Z"/></g>
			<g><path style="opacity:0.998" fill="#5bc97f" d="M 182.5,202.5 C 182.167,205.167 181.833,207.833 181.5,210.5C 206.167,210.5 230.833,210.5 255.5,210.5C 255.5,220.5 255.5,230.5 255.5,240.5C 230.167,240.5 204.833,240.5 179.5,240.5C 179.5,242.833 179.5,245.167 179.5,247.5C 158.167,268.5 136.833,289.5 115.5,310.5C 107.868,304.536 100.868,297.869 94.5,290.5C 123.5,260.833 152.833,231.5 182.5,202.5 Z"/></g>
			<g><path style="opacity:0.998" fill="#00ab5e" d="M 329.5,203.5 C 358.833,232.167 387.833,261.167 416.5,290.5C 410.132,297.869 403.132,304.536 395.5,310.5C 374.167,289.5 352.833,268.5 331.5,247.5C 331.5,245.167 331.5,242.833 331.5,240.5C 306.167,240.5 280.833,240.5 255.5,240.5C 255.5,230.5 255.5,220.5 255.5,210.5C 280.167,210.5 304.833,210.5 329.5,210.5C 329.5,208.167 329.5,205.833 329.5,203.5 Z"/></g>
			<g><path style="opacity:1" fill="#7ee780" d="M 255.5,240.5 C 255.5,250.5 255.5,260.5 255.5,270.5C 230.5,270.5 205.5,270.5 180.5,270.5C 180.32,262.825 179.986,255.158 179.5,247.5C 179.5,245.167 179.5,242.833 179.5,240.5C 204.833,240.5 230.167,240.5 255.5,240.5 Z"/></g>
			<g><path style="opacity:1" fill="#5ac87f" d="M 255.5,240.5 C 280.833,240.5 306.167,240.5 331.5,240.5C 331.5,242.833 331.5,245.167 331.5,247.5C 331.825,255.352 331.492,263.018 330.5,270.5C 305.5,270.5 280.5,270.5 255.5,270.5C 255.5,260.5 255.5,250.5 255.5,240.5 Z"/></g>
			<g><path style="opacity:0.996" fill="#01ab5e" d="M 179.5,247.5 C 179.986,255.158 180.32,262.825 180.5,270.5C 181.521,276.13 181.687,281.796 181,287.5C 166.965,301.702 152.799,315.702 138.5,329.5C 129.954,324.292 122.287,317.959 115.5,310.5C 136.833,289.5 158.167,268.5 179.5,247.5 Z"/></g>
			<g><path style="opacity:0.996" fill="#02914c" d="M 331.5,247.5 C 352.833,268.5 374.167,289.5 395.5,310.5C 388.394,317.875 380.728,324.541 372.5,330.5C 372.167,330.5 371.833,330.5 371.5,330.5C 357.869,316.368 344.035,302.368 330,288.5C 330.163,282.527 330.33,276.527 330.5,270.5C 331.492,263.018 331.825,255.352 331.5,247.5 Z"/></g>
			<g><path style="opacity:1" fill="#5ac97f" d="M 180.5,270.5 C 205.5,270.5 230.5,270.5 255.5,270.5C 255.5,280.5 255.5,290.5 255.5,300.5C 231.5,300.5 207.5,300.5 183.5,300.5C 185.167,310.501 186.834,320.501 188.5,330.5C 171.833,330.5 155.167,330.5 138.5,330.5C 138.5,330.167 138.5,329.833 138.5,329.5C 152.799,315.702 166.965,301.702 181,287.5C 181.687,281.796 181.521,276.13 180.5,270.5 Z"/></g>
			<g><path style="opacity:1" fill="#01ab5e" d="M 255.5,270.5 C 280.5,270.5 305.5,270.5 330.5,270.5C 330.33,276.527 330.163,282.527 330,288.5C 344.035,302.368 357.869,316.368 371.5,330.5C 355.167,330.5 338.833,330.5 322.5,330.5C 324.681,320.595 326.347,310.595 327.5,300.5C 303.5,300.5 279.5,300.5 255.5,300.5C 255.5,290.5 255.5,280.5 255.5,270.5 Z"/></g>
			<g><path style="opacity:1" fill="#7ee781" d="M 255.5,300.5 C 255.5,310.5 255.5,320.5 255.5,330.5C 233.167,330.5 210.833,330.5 188.5,330.5C 186.834,320.501 185.167,310.501 183.5,300.5C 207.5,300.5 231.5,300.5 255.5,300.5 Z"/></g>
			<g><path style="opacity:1" fill="#5ac87f" d="M 255.5,300.5 C 279.5,300.5 303.5,300.5 327.5,300.5C 326.347,310.595 324.681,320.595 322.5,330.5C 300.167,330.5 277.833,330.5 255.5,330.5C 255.5,320.5 255.5,310.5 255.5,300.5 Z"/></g>
			<g><path style="opacity:0.992" fill="#885d3c" d="M 138.5,330.5 C 155.167,330.5 171.833,330.5 188.5,330.5C 210.833,330.5 233.167,330.5 255.5,330.5C 255.5,340.5 255.5,350.5 255.5,360.5C 210.997,360.168 166.664,360.501 122.5,361.5C 111.5,361.5 100.5,361.5 89.5,361.5C 89.5,351.167 89.5,340.833 89.5,330.5C 105.833,330.5 122.167,330.5 138.5,330.5 Z"/></g>
			<g><path style="opacity:0.993" fill="#704c2f" d="M 255.5,330.5 C 277.833,330.5 300.167,330.5 322.5,330.5C 338.833,330.5 355.167,330.5 371.5,330.5C 371.833,330.5 372.167,330.5 372.5,330.5C 388.833,330.5 405.167,330.5 421.5,330.5C 421.5,340.833 421.5,351.167 421.5,361.5C 410.5,361.5 399.5,361.5 388.5,361.5C 388.737,362.791 388.404,363.791 387.5,364.5C 387.5,363.5 387.5,362.5 387.5,361.5C 343.5,361.5 299.5,361.5 255.5,361.5C 255.5,401.5 255.5,441.5 255.5,481.5C 221.16,481.833 186.827,481.5 152.5,480.5C 142.028,440.947 132.028,401.28 122.5,361.5C 166.664,360.501 210.997,360.168 255.5,360.5C 255.5,350.5 255.5,340.5 255.5,330.5 Z"/></g>
			<g><path style="opacity:1" fill="#523522" d="M 387.5,364.5 C 378.463,403.316 368.796,441.983 358.5,480.5C 324.173,481.5 289.84,481.833 255.5,481.5C 255.5,441.5 255.5,401.5 255.5,361.5C 299.5,361.5 343.5,361.5 387.5,361.5C 387.5,362.5 387.5,363.5 387.5,364.5 Z"/></g>
			</svg>
	</a>
	<div class="ms-5 flex sm:flex-col">
		<span class="text-xl font-bold sm:text-2xl">~/bermudev/blog</span>
		<nav
			id="navigation-menu"
			class="absolute -inset-x-4 top-14 hidden flex-col items-end gap-y-4 rounded-md bg-bgColor/[.85] py-4 text-accent shadow backdrop-blur group-[.menu-open]:z-50 group-[.menu-open]:flex sm:static sm:z-auto sm:-ms-4 sm:mt-1 sm:flex sm:flex-row sm:items-center sm:divide-x sm:divide-dashed sm:divide-accent sm:rounded-none sm:bg-transparent sm:py-0 sm:shadow-none sm:backdrop-blur-none"
			aria-label="Main menu"
		>
			{
				menuLinks.map((link) => (
					<a
						href={link.path}
						class="px-4 py-4 sm:py-0 sm:hover:underline"
						aria-current={url.pathname === link.path ? "page" : false}
						data-astro-prefetch
					>
						{link.title}
					</a>
				))
			}
		</nav>
	</div>
	<Search />
	<ThemeToggle />
	<mobile-button>
		<button
			id="toggle-navigation-menu"
			class="group relative ms-4 h-7 w-7 sm:invisible sm:hidden"
			type="button"
			aria-label="Open main menu"
			aria-expanded="false"
			aria-haspopup="menu"
		>
			<svg
				id="line-svg"
				class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 transition-all group-aria-expanded:scale-0 group-aria-expanded:opacity-0"
				aria-hidden="true"
				focusable="false"
				xmlns="http://www.w3.org/2000/svg"
				fill="none"
				viewBox="0 0 24 24"
				stroke-width="1.5"
				stroke="currentColor"
			>
				<path stroke-linecap="round" stroke-linejoin="round" d="M3.75 9h16.5m-16.5 6.75h16.5"
				></path>
			</svg>
			<svg
				id="cross-svg"
				class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 scale-0 text-accent opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100"
				class="text-accent"
				aria-hidden="true"
				focusable="false"
				xmlns="http://www.w3.org/2000/svg"
				fill="none"
				viewBox="0 0 24 24"
				stroke-width="1.5"
				stroke="currentColor"
			>
				<path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path>
			</svg>
		</button>
	</mobile-button>
</header>

<script>
	import { toggleClass } from "@/utils";

	class MobileNavBtn extends HTMLElement {
		private headerEl: HTMLElement;
		private mobileButtonEl: HTMLButtonElement;
		private menuOpen: boolean;

		constructor() {
			super();
			this.headerEl = document.getElementById("main-header")!;
			this.mobileButtonEl = this.querySelector("button") as HTMLButtonElement;
			this.menuOpen = false;

			this.mobileButtonEl.addEventListener("click", this.toggleMobileMenu);
		}

		toggleMobileMenu = () => {
			toggleClass(this.headerEl, "menu-open");
			this.menuOpen = !this.menuOpen;
			this.mobileButtonEl.setAttribute("aria-expanded", this.menuOpen.toString());
		};
	}

	customElements.define("mobile-button", MobileNavBtn);
</script>
